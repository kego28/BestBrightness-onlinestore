<!-- <ion-header >
  <ion-toolbar>
    <ion-title>Inventory Store</ion-title>
    <ion-buttons slot="start" class="burger-icon">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-buttons slot="end" class="desktop-nav">
      <ion-button>About</ion-button>
      <ion-button>Contact</ion-button>
      <ion-button>Privacy Policy</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-menu contentId="main-content" side="start">
  <ion-header>
    <ion-toolbar>
      <ion-title>Menu</ion-title>
    </ion-toolbar>
  </ion-header>
</ion-menu>

<ion-content [fullscreen]="true" class="ion-padding">
  <div class="background-container">
    <div class="content-container">
      <ion-grid>
        <ion-row>
          <ion-col size-md="6" size-lg="4" *ngFor="let promo of promotions">
            <ion-card class="promo-card">
              <ion-card-header>
                <ion-card-subtitle>{{ promo.discount_percentage }}% OFF</ion-card-subtitle>
                <ion-card-title>{{ promo.name }}</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <p>{{ promo.description }}</p>
                <p><strong>Product:</strong> {{ promo.product_name }}</p>
                <ion-chip [color]="isPromotionValid(promo.end_date) ? 'success' : 'danger'" outline="true">
                  <ion-icon [name]="isPromotionValid(promo.end_date) ? 'time-outline' : 'alert-circle-outline'"></ion-icon>
                  <ion-label>
                    {{ isPromotionValid(promo.end_date) ? getDaysRemaining(promo.end_date) + ' days left' : 'Expired' }}
                  </ion-label>
                </ion-chip>
              </ion-card-content>
              <ion-button expand="block" fill="clear" [disabled]="!isPromotionValid(promo.end_date)">
                Shop Now
              </ion-button>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>
  </div>
</ion-content> -->
<!-- 
<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-title class="ion-text-center">
      <strong>Flash Deals</strong>
    </ion-title>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-buttons slot="end" class="desktop-nav">
      <ion-button>About</ion-button>
      <ion-button>Contact</ion-button>
      <ion-button>Privacy Policy</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-menu contentId="main-content" side="start">
  <ion-header>
    <ion-toolbar>
      <ion-title>Menu</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-item>About</ion-item>
      <ion-item>Contact</ion-item>
      <ion-item>Privacy Policy</ion-item>
    </ion-list>
  </ion-content>
</ion-menu> -->

<ion-header class="main-header" [class.header-scrolled]="isScrolled">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="toggleMenu()" class="mobile-menu-button">
        <ion-icon name="menu-outline"></ion-icon>
      </ion-button>
      <ion-title>
        <img src="assets/icon/logo.png" class="logo" alt="BestBrightness Store"/>
      
      </ion-title>
    </ion-buttons>
    
    <ion-buttons slot="end" class="desktop-nav">
  
      <ion-button routerLink="/products">
        <ion-icon name="home-outline"></ion-icon>
        <span>Home</span>
      </ion-button>
      <ion-button routerLink="/account">
        <ion-icon name="person-outline"></ion-icon>
        <span>Account</span>
      </ion-button>
      
      <ion-button routerLink="/promotions">
        <ion-icon name="gift-outline"></ion-icon>
        <span>Promotions</span>
      </ion-button>
      <ion-button routerLink="/about-us">
        <ion-icon name="information-circle-outline"></ion-icon>
        <span>About Us</span>
      </ion-button>
      <ion-button routerLink="/contact">
        <ion-icon name="mail-outline"></ion-icon>
        <span>Contact</span>
      </ion-button>
      <ion-button routerLink="/privacy-policy">
        <ion-icon name="lock-closed-outline"></ion-icon>
        <span>Privacy</span>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

  <!-- <ion-content class="ion-padding"> -->
    <ion-content id="main-content">
  <div class="mobile-menu" [class.show-menu]="isMenuOpen">
    <ion-list>
      <ion-item routerLink="/products" (click)="closeMenu()">
        <ion-icon name="house-outline" slot="start"></ion-icon>
        <ion-label>Home</ion-label>
      </ion-item>
      <ion-item routerLink="/account" (click)="closeMenu()">
        <ion-icon name="person-outline" slot="start"></ion-icon>
        <ion-label>Account</ion-label>
      </ion-item>
    
      <ion-item routerLink="/promotions" (click)="closeMenu()">
        <ion-icon name="gift-outline" slot="start"></ion-icon>
        <ion-label>Promotions</ion-label>
      </ion-item>
      <ion-item routerLink="/about-us" (click)="closeMenu()">
        <ion-icon name="information-circle-outline" slot="start"></ion-icon>
        <ion-label>About Us</ion-label>
      </ion-item>
      <ion-item routerLink="/contact" (click)="closeMenu()">
        <ion-icon name="mail-outline" slot="start"></ion-icon>
        <ion-label>Contact</ion-label>
      </ion-item>
      <ion-item routerLink="/privacy-policy" (click)="closeMenu()">
        <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
        <ion-label>Privacy Policy</ion-label>
      </ion-item>
    </ion-list>
  </div>

  <div class="background-container">
    <div class="header-section">
      <h1>Limited Time Offers</h1>
      <p>Discover amazing deals on our best products</p>
    </div>

    <div class="content-container">
      <ng-container *ngIf="!error; else errorMessage">
        <ion-grid>
          <ion-row>
            <ion-col size-sm="12" size-md="6" size-lg="4" *ngFor="let promo of promotions">
              <ion-card class="promo-card" [class.expired]="!isPromotionValid(promo.end_date)">
                <div class="discount-badge">
                  <span>{{promo.discount_percentage}}%</span>
                  <small>OFF</small>
                </div>
                
                <ion-card-header>
                  <ion-card-title>{{promo.name}}</ion-card-title>
                  <ion-card-subtitle>{{promo.product_name}}</ion-card-subtitle>
                </ion-card-header>

                <ion-card-content>
                  <p class="description">{{promo.description}}</p>

                  <ng-container *ngIf="isPromotionValid(promo.end_date); else expiredBadge">
                    <div class="countdown-container">
                      <div class="countdown-header">
                        <ion-icon name="time-outline"></ion-icon>
                        <span>Time Remaining:</span>
                      </div>
                      <div class="countdown-timer">
                        <ng-container *ngVar="getTimeRemaining(promo.end_date) as time">
                          <div class="time-block">
                            <span class="number">{{time.days}}</span>
                            <small>days</small>
                          </div>
                          <div class="time-block">
                            <span class="number">{{time.hours}}</span>
                            <small>hours</small>
                          </div>
                          <div class="time-block">
                            <span class="number">{{time.minutes}}</span>
                            <small>mins</small>
                          </div>
                        </ng-container>
                      </div>
                    </div>
                  </ng-container>

                  <ng-template #expiredBadge>
                    <div class="expired-badge">
                      <ion-icon name="alert-circle-outline"></ion-icon>
                      <span>Promotion Expired</span>
                    </div>
                  </ng-template>

                  <ion-button 
                    expand="block" 
                    class="shop-button"
                    [disabled]="!isPromotionValid(promo.end_date)"
                    (click)="onShopNow(promo)">
                    <ion-icon name="cart-outline" slot="start"></ion-icon>
                    Shop Now
                  </ion-button>
                </ion-card-content>
              </ion-card>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ng-container>

      <ng-template #errorMessage>
        <div class="error-container">
          <ion-icon name="alert-circle-outline" size="large"></ion-icon>
          <h2>{{ error }}</h2>
          <ion-button (click)="fetchPromotions()">Try Again</ion-button>
        </div>
      </ng-template>
    </div>
  </div>
</ion-content>